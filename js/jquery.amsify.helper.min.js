// Amsify42 Helper 1.0.0
// http://www.amsify42.com
!function(AmsifyHelper,$,undefined){function checkMessage(e,s){var r="black";s!==undefined&&("error"==s?(r="red",e="✘ "+e):"success"==s?(r="green",e="✔ "+e):"info"==s&&(r="blue"));var n=!1;if(AmsifyHelper.detectIE()?$(".amsify-fixed-message").html()===undefined&&(n=!0):$(".amsify-fixed-message").length||(n=!0),n){var t=[{"<div/>":{"class":"amsify-fixed-message "+r,text:e},prependTo:"body"},{"<span/>":{"class":"amsify-message-close",text:"✖"},appendTo:".amsify-fixed-message"}];AmsifyHelper.addHTML(t)}else $(".amsify-fixed-message").attr("class","amsify-fixed-message "+r).html(e+'<span class="amsify-message-close">X</span>')}function setFlashMessage(){$(document).on("click",".amsify-message-close",function(){$(this).parent(".amsify-fixed-message").slideUp()})}function getPreceedingSpecialChars(e,s,r){for(var n="",t=e,a=s.length;a>t&&-1!=$.inArray(t,r);t++)$.inArray(t,r)>-1&&(n+=s[t]);return n}function replaceAt(e,s,r){return e.substr(0,r)+s+e.substr(r+1)}setFlashMessage(),AmsifyHelper.base_url=window.location.protocol+"//"+window.location.host,AmsifyHelper.AppUrl=function(e){var s=AmsifyHelper.base_url;return AmsifyHelper.getLocale()&&(s+="/"+AmsifyHelper.getLocale()),s+="/"+e},AmsifyHelper.getLocale=function(e){return $('meta[name="_locale"]').attr("content")},AmsifyHelper.getToken=function(){return $('meta[name="_token"]').attr("content")},AmsifyHelper.setEvent=function(e,s,r,n){e?$(document).on(s,r,n):$(r).on(s,n)},AmsifyHelper.fieldByName=function(e){return'*[name="'+e+'"]'},AmsifyHelper.getActionURL=function(e){var s=AmsifyHelper.base_url,r=new RegExp("^(?:[a-z]+:)?//","i");return r.test(e)?s=e:s+="/"+e,s},AmsifyHelper.stopSubmit=function(e,s,r,n){return e.preventDefault(),s!==undefined&&r!==undefined&&$submitSelector.prop("disabled",!1).html(r),n!==undefined?n:void 0},AmsifyHelper.detectIE=function(){var e=window.navigator.userAgent,s=e.indexOf("MSIE ");if(s>0)return parseInt(e.substring(s+5,e.indexOf(".",s)),10);var r=e.indexOf("Trident/");if(r>0){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var t=e.indexOf("Edge/");return t>0?parseInt(e.substring(t+5,e.indexOf(".",t)),10):!1},AmsifyHelper.getFormData=function(e,s,r){var n;return AmsifyHelper.detectIE()||s!==undefined&&s!==!1?(n=$(e).serialize(),r!==undefined&&getObjectSize(r)>0&&$.each(r,function(e,s){n+="&"+e+"="+s})):(n=new FormData($(e)[0]),r!==undefined&&getObjectSize(r)>0&&$.each(r,function(e,s){n.append(e,s)})),n},AmsifyHelper.getObjectSize=function(e,s){var s,r=0;for(s in e)e.hasOwnProperty(s)&&r++;return r},AmsifyHelper.distinctArray=function(e){var s=[];return $.each(e,function(e,r){-1==$.inArray(r,s)&&s.push(r)}),s},AmsifyHelper.upperCaseFirst=function(e){return e.replace(/^[a-z]/,function(e){return e.toUpperCase()})},AmsifyHelper.showURL=function(e,s){if(0==AmsifyHelper.detectIE()){var r="";e!==undefined&&(r+=e),s!==undefined&&(r+="?page="+s),window.history.pushState("","",r),$("html, body").animate({scrollTop:0},"slow")}},AmsifyHelper.showFlash=function(e,s){e!==undefined&&($(".amsify-fixed-message").length&&"block"==$(".amsify-fixed-message").css("display")?$(".amsify-fixed-message").slideUp("fast",function(){checkMessage(e,s),$(".amsify-fixed-message").slideDown(),setTimeout(function(){$(".amsify-fixed-message").slideUp()},5e3)}):(checkMessage(e,s),$(".amsify-fixed-message").slideDown(),setTimeout(function(){$(".amsify-fixed-message").slideUp()},5e3)))},AmsifyHelper.addHTML=function(e){$.each(e,function(e,s){var r;s!==undefined&&$.each(s,function(e,s){"appendTo"!=e&&"prependTo"!=e?r=$(e,s):r[e](s)})})},AmsifyHelper.iterateErrors=function(e){$.each(e,function(e,s){AmsifyHelper.showError(e,s)})},AmsifyHelper.callback=function(config,key,selector,attr){var checkAttr=!0;config!==undefined&&config[key]!==undefined&&"function"==typeof config[key]&&(checkAttr=!1,config[key]()),checkAttr&&selector!==undefined&&attr!==undefined&&$(selector).attr(attr)&&eval($(selector).attr(attr))},AmsifyHelper.bodyLoaderIEfix=function(e){AmsifyHelper.detectIE()&&(e!==undefined?"modal"==e&&$(".modal-body-loader").css({top:"0",left:"0"}):$(".section-body-loader").css({top:"0",left:"0"}))},AmsifyHelper.getSortIcon=function(e,s,r){var n=[];if("bootstrap"==s){n.basic=' <span class="fa fa-sort"></span>';var t=e.split("class="),a=$.trim(t[1]);""==a||'"fa fa-sort"></span>'==a?(n.insertHtml=' <span class="fa fa-sort-asc"></span>',n.sort_type="asc"):'"fa fa-sort-asc"></span>'==a?(n.insertHtml=' <span class="fa fa-sort-desc"></span>',n.sort_type="desc"):(n.insertHtml=' <span class="fa fa-sort"></span>',n.sort_type="default")}else{n.basic=' <span class="sort-icon"><img src="'+AmsifyHelper.base_url+'/images/arrow-updown.png"></span>';var t=e.split('class="sort-icon">'),a=$.trim(t[1]);""==a||a=='<img src="'+AmsifyHelper.base_url+'/images/arrow-updown.png"></span>'?(n.insertHtml=' <span class="sort-icon"><img src="'+AmsifyHelper.base_url+'/images/arrow-up.png"></span>',n.sort_type="asc"):a=='<img src="'+AmsifyHelper.base_url+'/images/arrow-up.png"></span>'?(n.insertHtml=' <span class="sort-icon"><img src="'+AmsifyHelper.base_url+'/images/arrow-down.png"></span>',n.sort_type="desc"):(n.insertHtml=' <span class="sort-icon"><img src="'+AmsifyHelper.base_url+'/images/arrow-updown.png"></span>',n.sort_type="default")}return n},AmsifyHelper.setDefaultSortIcon=function(e,s){var r=' <span class="sort-icon"><img src="'+AmsifyHelper.base_url+'/images/arrow-updown.png"></span>';"bootstrap"==s?($(e).find(".fa").remove(),r=' <span class="fa fa-sort"></span>'):$(e).find(".sort-icon").remove(),$(e).append(r)},AmsifyHelper.fileSize=function(e,s){if(0==e)return"0 Bytes";var r=1e3,n=s+1||3,t=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],a=Math.floor(Math.log(e)/Math.log(r));return parseFloat((e/Math.pow(r,a)).toFixed(n))+" "+t[a]},AmsifyHelper.shortFileName=function(e,s,r){var n=15,t="...";return s!==undefined&&(n=s),r!==undefined&&(t=r),e.length>n&&(e=t+$.trim(e).substring(e.length-n).trim(this)),e},AmsifyHelper.setDraggableSort=function(e,s,r,n,t){var a="amsify";t!==undefined&&t.type!==undefined&&(a=t.type);var i=$(e).children();$.each(i,function(e,s){if(!$(s).find(".refresher").length&&!$(s).hasClass("unsort")){$(s).prop("tagName").toLowerCase();$(s).children().first().prepend(AmsifyHelper.reorderImage(a))}});var t={};$(function(){$(e).sortable({placeholder:"ui-state-highlight",handle:".refresher",cancel:".unsort",stop:function(a,i){n.ids=[];var o=$(e).sortable("refreshPositions").children();$.each(o,function(e,s){$(s).attr(r)?n.ids.push($(s).attr(r)):$(s).attr("id")&&n.ids.push($(s).attr("id"))}),t.beforeSend=function(){$(e).sortable("disable")},t.afterError=function(s){$(e).sortable("cancel")},t.complete=function(){$(e).sortable("enable")},AmsifyHelper.callAjax(s,n,t)},helper:function(e,s){return s.children().each(function(){$(this).width($(this).width())}),s}}),$(e).disableSelection()})},AmsifyHelper.reorderImage=function(e){var s='<img class="refresher" src="'+AmsifyHelper.base_url+'/images/move.png"/>';return"bootstrap"==e?s='<a class="refresher"><span class="fa fa-arrows"></span></a>':"materialize"==e&&(s='<a class="refresher"><span class="material-icons">open_with</span></a>'),s},AmsifyHelper.callAjax=function(e,s,r,n){var t="POST";n!==undefined&&""!=n&&(t=n),s._token===undefined&&(s._token=AmsifyHelper.getToken());var a={type:t,url:AmsifyHelper.getActionURL(e),data:s};"post"==$.trim(t)&&(a.processData=!1,a.cache=!1,AmsifyHelper.detectIE()||(a.contentType=!1)),r!==undefined&&(r.beforeSend!==undefined&&"function"==typeof r.beforeSend&&(a.beforeSend=r.beforeSend),r.xhr!==undefined&&"function"==typeof r.xhr&&(a.xhr=r.xhr),r.complete!==undefined&&"function"==typeof r.complete&&(a.complete=r.complete)),a.success=function(e){e.status!==undefined&&("error"==e.status?(AmsifyHelper.showFlash(e.message,"error"),r!==undefined&&r.afterError!==undefined&&"function"==typeof r.afterError&&r.afterError(e)):"errors"==e.status?AmsifyHelper.iterateErrors(e.message):"info"==e.status?AmsifyHelper.iterateErrors(e.message,"info"):(AmsifyHelper.showFlash(e.message,"success"),r!==undefined&&r.afterSuccess!==undefined&&"function"==typeof r.afterSuccess&&r.afterSuccess(e)))},a.error=function(e){AmsifyHelper.showFlash(e.status+":"+e.statusText,"error"),r!==undefined&&r.afterResponseError!==undefined&&"function"==typeof r.afterResponseError&&r.afterResponseError(e)},$.ajax(a)},AmsifyHelper.upperCase=function(e){$(e).on("keyup focusout",function(){this.value=this.value.toUpperCase()})},AmsifyHelper.onlyDecimals=function(e){$(e).on("keyup focusout",function(e){this.value=this.value.replace(/[^0-9\.]/g,"")})},AmsifyHelper.onlyNumbers=function(e){$(e).on("keyup focusout",function(e){this.value=this.value.replace(/[^0-9]/g,"")})},AmsifyHelper.noSpecialChar=function(e){$(e).on("keyup focusout",function(e){return 32===e.which?!1:void(this.value=this.value.replace(/[^a-z0-9\s]/gi,"").replace(/[_\s]/g," "))})},AmsifyHelper.singleSpace=function(e){$(e).on("keyup focusout",function(e){this.value=this.value.replace(/\s+/g," ")})},AmsifyHelper.noSpace=function(e){$(e).on("keyup focusout",function(e){32===e.which&&e.preventDefault(),$(this).val(function(e,s){return s.replace(/\s/g,"")})}).blur(function(){$(this).val(function(e,s){return s.replace(/\s/g,"")})})},AmsifyHelper.mask=function(e,s,r){$(e).on("keyup focusout",function(e){var n=e.charCode||e.keyCode||0;if(8!=n){var t="numbers",a=["numbers","alphabets","alphanumeric"];if(r!==undefined&&-1!=jQuery.inArray(r,a)&&(t=r),s!==undefined){var i=$.trim($(this).val());if(i.length>s.length)return i=i.substr(0,s.length),$(this).val(i),!1;for(var o=[],f=[],c=0,l=s.length;l>c;c++)s[c].match(/[0-9a-z]/i)?o.push(c):f.push(c);for(var u=!1,c=0,l=i.length;l>c;c++)if("numbers"==t&&!i[c].match(/[0-9]/i)&&i[c]!=s[c]||"alphabets"==t&&!i[c].match(/[a-z]/i)&&i[c]!=s[c]?u=!0:"alphanumeric"!=t||i[c].match(/[0-9a-z]/i)||i[c]==s[c]||(u=!0),u)return $(this).val(replaceAt(i,"",c)),!1;for(var c=0,l=s.length;l>c;c++)if(c<i.length&&-1!=$.inArray(c,f)&&i[c]!=s[c]){var p=getPreceedingSpecialChars(c,s,f),d=p+""+i[c];i=replaceAt(i,d,c)}var m=getPreceedingSpecialChars(i.length,s,f);""!=m&&(i+=m),$(this).val(i)}}})}}(window.AmsifyHelper=window.AmsifyHelper||{},jQuery);